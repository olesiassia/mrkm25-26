# Лабораторна робота №4

## Тема: Дослідження особливостей реалізації існуючих програмних систем

**Виконав:** Булигін Олексій  
**Дата:** 25 Грудня 2025

---

## 1. Мета роботи

Перевірити коректність протоколу несуперечливого підпису

## 2. Теоретичні відомості

### 2.1. Незаперечні підписи

Незаперечні підписи (undeniable signatures) відрізняються від звичайних цифрових підписів ключовою властивістю: **верифікація вимагає взаємодії з підписувачем**. Це забезпечує:

1. **Непередаваність** — підписи не можуть бути показані третім сторонам без участі підписувача
2. **Вибіркове розкриття** — підписувач контролює, хто може верифікувати його підписи
3. **Заперечуваність** — підписувач може довести, що підпис НЕ його

### 2.2. Математичні основи

Схема базується на проблемі дискретного логарифма (DLP) в мультиплікативній групі $\mathbb{Z}_p^*$:

- **Параметри:** безпечне просте число $p = 2q + 1$, генератор $g$ порядку $q$
- **Приватний ключ:** $x \in [1, q-1]$
- **Публічний ключ:** $y = g^x \mod p$
- **Підпис повідомлення $m$:** $s = H(m)^x \mod p$

### 2.3. Протокол інтерактивної верифікації

1. Верифікатор обирає випадкові $a, b$ та надсилає виклик $C = m^a \cdot g^b \mod p$
2. Підписувач обчислює відповідь $R = C^x \mod p$
3. Верифікатор перевіряє: $R \stackrel{?}{=} s^a \cdot y^b \mod p$

## 3. Реалізовані атаки

### 3.1. Атака повним перебором на DLP

**Мета:** Знайти приватний ключ $x$ за публічним ключем $y = g^x \mod p$

**Метод:** Послідовний перебір всіх можливих значень $x$ від 0 до $q-1$

**Результати тестування:**

| Розмір ключа | Час зламу | Кількість спроб |
|--------------|-----------|-----------------|
| 20 біт | 144 мс | 360,548 |
| 24 біт | 1.1 сек | 3,116,421 |
| 26 біт | 6.7 сек | 19,640,882 |

**Прогнози часу для більших ключів:**

| Розмір ключа | Прогнозований час |
|--------------|-------------------|
| 32 біт | ~24 хвилини |
| 40 біт | ~4 дні |
| 48 біт | ~3 роки |
| 64 біт | ~550 років |
| 80 біт | ~36 млн років |
| 128 біт | $10^{14}$ × вік Всесвіту |
| 1536 біт | дуже довго |

**Пороговий розмір ключа:** Атака перебором стає нездійсненною (перевищує вік Всесвіту 13.8 млрд років) для ключів розміром **≥80 біт**.

**Висновок:** Для криптографічних розмірів ключів (1536+ біт) атака повним перебором абсолютно нездійсненна.

### 3.2. Підробка транскриптів (демонстрація непередаваності)

**Мета:** Продемонструвати, що транскрипти верифікації не можуть переконати третю сторону

**Ключове спостереження:** Рівняння верифікації $R = s^a \cdot y^b \mod p$ може бути задоволене шляхом вибору $(a, b, R)$, що його задовольняють, без знання чи є підпис $s$ дійсним!

**Процедура атаки:**
1. Обрати довільні $a, b \in [1, q-1]$
2. Обчислити $R = s^a \cdot y^b \mod p$
3. Представити $(a, b, R)$ як "доказ" верифікації

**Результат:** Третя сторона, що перевіряє лише $R \stackrel{?}{=} s^a \cdot y^b$, буде обманута.

**Тест підтвердив:**
- ✓ Підроблений транскрипт проходить статичну перевірку
- ✓ Підроблений транскрипт НЕ проходить інтерактивну верифікацію

**Висновок:** Це демонструє ЧОМУ незаперечні підписи вимагають інтерактивної верифікації. Транскрипти самі по собі нічого не доводять, оскільки будь-хто може їх підробити.

### 3.3. Атаки на підробку підписів

#### 3.3.1. Випадкова підробка
- **Метод:** Генерація випадкових значень $s$
- **Результат:** 0/1000 успішних спроб

#### 3.3.2. Алгебраїчна підробка
- **Метод:** Спроба $s = y^k$ для різних $k$
- **Результат:** 0/500 успішних спроб

#### 3.3.3. Підробка пов'язаних повідомлень
- **Метод:** Маючи підпис $s_1$ для $m_1$, спробувати створити підпис для $m_2$
- **Варіанти:** $s^2$, $s \cdot g$, $s \cdot y$, $s^{-1}$
- **Результат:** 0/10 успішних спроб

**Висновок:** Без приватного ключа $x$ підробка підписів обчислювально нездійсненна.

### 3.4. Атаки на протокол виклик-відповідь

#### 3.4.1. Атака повторного відтворення (Replay)
- **Метод:** Перехоплення та повторне використання пари $(C, R)$
- **Результат:** Неможливо — кожна верифікація використовує свіжі випадкові значення

#### 3.4.2. Передбачення відповіді
- **Метод:** Спроба вгадати $R = C^x$ без знання $x$
- **Результат:** 0/50 успішних спроб

**Висновок:** Протокол виклик-відповідь захищений від маніпуляцій завдяки свіжим випадковим викликам. Формально у зловмисника (у випадку MitM) є лише одна спроба

### 3.6. Зловживання протоколом заперечення

#### 3.6.1. Тест на обґрунтованість (Soundness)
- **Питання:** Чи можна заперечити дійсний підпис?

#### 3.6.2. Тест на повноту (Completeness)
- **Питання:** Чи можна завжди заперечити недійсний підпис?

### 3.7 Атаки на слабкі параметри

#### 3.7.1 Pohlig-Hellman (smooth order)
- **Умова:** p-1 має багато малих простих дільників
- **Результат:** DLP розкладається через CRT
- **Захист:** safe prime p = 2q + 1

#### 3.7.2 Small subgroup attack  
- **Умова:** генератор g має малий порядок
- **Результат:** brute-force по малій кількості значень
- **Захист:** перевірка g^q = 1, g ≠ 1

#### 3.7.3 Trivial generator
- **Умова:** g = 1 або g = p-1
- **Результат:** y = 1 або порядок 2
- **Захист:** валідація при генерації ключів

## 7. Висновки

1. **Схема Чаума-ван Антверпена є криптографічно стійкою** при використанні відповідних розмірів ключів (≥1536 біт).

2. **Атака повним перебором** практично здійсненна лише для ключів розміром <32 біт. Для криптографічних розмірів час атаки перевищує вік Всесвіту на багато порядків.

3. **Непередаваність** — ключова властивість, що відрізняє незаперечні підписи від звичайних. Демонстрація підробки транскриптів показує, чому інтерактивна верифікація є обов'язковою.

4. **Всі типи атак на підробку** (випадкова, алгебраїчна, пов'язаних повідомлень) провалюються для криптографічних розмірів ключів.

5. **Протокол заперечення** працює коректно: дійсні підписи ніколи не можуть бути заперечені (обґрунтованість), а недійсні завжди можуть бути заперечені (повнота).

6. **Безпека схеми** повністю базується на складності проблеми дискретного логарифма в групі $\mathbb{Z}_p^*$.

## 8. Список використаних джерел

1. Chaum, D., & van Antwerpen, H. (1990). Undeniable signatures. CRYPTO '89.
